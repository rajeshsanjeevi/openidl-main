{"extractionPatternID":"ZIP_POLICY_COUNT_01","extractionPatternName":"ZipCode Policy Count","description":"Personal Auto Policy Count","jurisdication":"AL","insurance":"Personal Auto","viewDefinition":{"map":"function map() {\n    let key = this.zipCode\n    let chunkId = this.chunkId\n    let policyId = this.policyId\n    let transactionName = this.transaction.name\n    var result = {\n        \"key\": { \"chunkId\": chunkId, \"zipcode\": key },\n        \"value\": {\n            \"transaction\": transactionName,\n            \"policyId\": policyId,\n            \"premium\": this.premium.amount ? parseFloat(this.premium.amount) : 0,\n            \"carrierId\": this.carrierId\n        }\n    }\n    emit(\n        result.key, result.value,\n    )\n}","reduce":"function reduce(key, value) {\n    let result = { \"totalPremium\": 0, \"totalPolicies\": 0 }\n    let policyIds = []\n    for (item of value) {\n        if (policyIds.includes(item.policyId)) {\n\n        } else {\n            result.value = { \"chunkId\": key.chunkId }\n            result.totalPolicies += 1\n        }\n        policyIds.push(item.policyId)\n        result.totalPremium += item.premium\n    }\n    return result;\n}"},"dbType":"mongo","version":"0.1","isActive":true,"effectiveStartTs":"2022-01-30T18:30:00Z","effectiveEndTs":"2023-01-30T18:30:00Z","premiumFromDate":"2022-01-30T18:30:00Z","premiumToDate":"2023-01-30T18:30:00Z","lossFromDate":"2022-01-30T18:30:00Z","lossToDate":"2023-01-30T18:30:00Z","updatedTs":"2021-12-14T22:22:00Z","updatedBy":"kens@aaisonline.com"}